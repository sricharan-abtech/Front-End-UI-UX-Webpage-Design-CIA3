<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Holiday Planner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f8fafc; }
    .card { border-radius:12px; }
    .itinerary-item.completed .activity-title { text-decoration: line-through; color:#6c757d; }
    .small-muted { font-size:0.9rem; color:#6c757d; }
    .destination-card { cursor:pointer; transition:transform .12s; }
    .destination-card:hover { transform: translateY(-4px); }
    @media (max-width:575px){ .controls-row { flex-direction:column; gap:.5rem; } }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="row mb-3">
      <div class="col-12 text-center">
        <h2>Holiday Planner</h2>
        <p class="small-muted">Plan trips, pick destinations, build itineraries and track budgets.</p>
      </div>
    </div>

    <div class="row g-3">
      <!-- Left column: Search & Destination list -->
      <div class="col-lg-4">
        <div class="card p-3">
          <h5>Search Destinations</h5>
          <div class="mb-2">
            <input id="search-input" class="form-control" placeholder="Search by name or tag (beach, mountains, city)">
          </div>
          <div class="mb-2 d-flex gap-2 controls-row">
            <select id="filter-type" class="form-select">
              <option value="">All types</option>
              <option value="beach">Beach</option>
              <option value="mountain">Mountain</option>
              <option value="city">City</option>
              <option value="adventure">Adventure</option>
            </select>
            <button id="reset-search" class="btn btn-outline-secondary">Reset</button>
          </div>

          <hr>
          <div id="dest-list" class="row g-2">
            <!-- destinations populated here -->
          </div>
        </div>
      </div>

      <!-- Middle column: Planner controls -->
      <div class="col-lg-4">
        <div class="card p-3">
          <h5>Plan Trip</h5>
          <div class="mb-2 small-muted">Selected Destination:</div>
          <div id="selected-destination" class="mb-2">None</div>

          <div class="mb-2">
            <label class="form-label">Accommodation</label>
            <select id="accommodation-select" class="form-select"><option value="">Select accommodation</option></select>
          </div>

          <div class="mb-2">
            <label class="form-label">Transport</label>
            <select id="transport-select" class="form-select"><option value="">Select transport</option></select>
          </div>

          <hr>
          <h6>Activity Planner</h6>
          <div class="mb-2">
            <select id="activity-select" class="form-select"></select>
          </div>
          <div class="mb-2 d-flex gap-2">
            <input id="activity-date" type="date" class="form-control">
            <input id="activity-time" type="time" class="form-control">
          </div>
          <div class="d-grid mt-2">
            <button id="add-activity" class="btn btn-success">Add to Itinerary</button>
          </div>
        </div>
      </div>

      <!-- Right column: Itinerary & Budget -->
      <div class="col-lg-4">
        <div class="card p-3 mb-3">
          <h5>Trip Itinerary</h5>
          <ul id="itinerary" class="list-group mb-2"></ul>
          <div class="text-end small-muted">Tip: click an item to mark as done, use delete to remove.</div>
        </div>

        <div class="card p-3">
          <h5>Budget Tracker</h5>
          <div class="mb-2 small-muted">Estimated Costs</div>
          <ul id="costs" class="list-group mb-2"></ul>
          <div class="d-flex justify-content-between align-items-center">
            <strong>Total:</strong><div id="total-cost">0</div>
          </div>
          <div class="mt-2 d-grid">
            <button id="clear-itinerary" class="btn btn-outline-danger">Clear Itinerary</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-4">
      <div class="col-12 text-center text-muted small">
        Demo uses sample data. All changes persist in localStorage for demo purposes.
      </div>
    </div>
  </div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Sample data (dummy)
const SAMPLE = {
  destinations: [
    {id:1, name:'Sunny Beach', type:'beach', desc:'Golden sands and calm waters.', avgCost: 500,
     accommodations:[{id:'h1', name:'Beach Resort', cost:120},{id:'h2', name:'Seaside B&B', cost:80}],
     transports:[{id:'t1', name:'Flight', cost:200},{id:'t2', name:'Train', cost:60}],
     activities:[{id:'a1', name:'Snorkeling', cost:30},{id:'a2', name:'Boat Tour', cost:45}]},
    {id:2, name:'Highland Peaks', type:'mountain', desc:'Hiking and scenic views.', avgCost: 400,
     accommodations:[{id:'h3', name:'Mountain Lodge', cost:100},{id:'h4', name:'Cabin', cost:70}],
     transports:[{id:'t3', name:'Car Rental', cost:90},{id:'t4', name:'Bus', cost:40}],
     activities:[{id:'a3', name:'Guided Hike', cost:25},{id:'a4', name:'Zipline', cost:50}]},
    {id:3, name:'Metropolis City', type:'city', desc:'Museums, food, nightlife.', avgCost: 600,
     accommodations:[{id:'h5', name:'Downtown Hotel', cost:150},{id:'h6', name:'Budget Inn', cost:60}],
     transports:[{id:'t5', name:'Flight', cost:220},{id:'t6', name:'Metro Pass', cost:15}],
     activities:[{id:'a5', name:'City Tour', cost:20},{id:'a6', name:'Food Tasting', cost:35}]}
  ]
};

// App state
let app = {
  destinations: SAMPLE.destinations,
  selectedDestination: null,
  itinerary: JSON.parse(localStorage.getItem('hp_itinerary') || '[]'),
  selections: JSON.parse(localStorage.getItem('hp_selections') || '{}')
};

function saveState(){ localStorage.setItem('hp_itinerary', JSON.stringify(app.itinerary)); localStorage.setItem('hp_selections', JSON.stringify(app.selections)); }

// Render destination cards
function renderDestinations(filterText='', filterType=''){
  const $list = $('#dest-list').empty();
  const items = app.destinations.filter(d => {
    const textMatch = (d.name + ' ' + d.desc + ' ' + d.type).toLowerCase().includes(filterText.toLowerCase());
    const typeMatch = filterType ? d.type === filterType : true;
    return textMatch && typeMatch;
  });
  if(items.length===0){ $list.append('<div class="col-12 small-muted">No destinations found.</div>'); return; }
  items.forEach(d => {
    const card = $(`<div class="col-12">
      <div class="card p-2 destination-card" data-id="${d.id}">
        <div class="d-flex justify-content-between">
          <div><strong>${d.name}</strong><div class="small-muted">${d.type} â€¢ ${d.desc}</div></div>
          <div class="text-end"><div class="small-muted">Est. $${d.avgCost}</div><button class="btn btn-sm btn-primary select-destination mt-2">Select</button></div>
        </div>
      </div>
    </div>`);
    $list.append(card);
  });
}

// When a destination is selected: populate accommodations, transports, activities
function selectDestinationById(id){
  const d = app.destinations.find(x=>x.id==id); if(!d) return;
  app.selectedDestination = d;
  $('#selected-destination').text(d.name + ' ('+d.type+')');
  // populate selects
  const $acc = $('#accommodation-select').empty().append('<option value="">Select accommodation</option>');
  d.accommodations.forEach(a=> $acc.append(`<option value="${a.id}" data-cost="${a.cost}">${a.name} - $${a.cost}/night</option>`));
  const $trans = $('#transport-select').empty().append('<option value="">Select transport</option>');
  d.transports.forEach(t=> $trans.append(`<option value="${t.id}" data-cost="${t.cost}">${t.name} - $${t.cost}</option>`));
  const $act = $('#activity-select').empty();
  d.activities.forEach(a=> $act.append(`<option value="${a.id}" data-cost="${a.cost}">${a.name} - $${a.cost}</option>`));
  // store selection stub
  app.selections.destination = d.id;
  saveState();
  renderCosts();
}

// Itinerary rendering
function renderItinerary(){
  const $it = $('#itinerary').empty();
  if(app.itinerary.length===0){ $it.append('<li class="list-group-item small-muted">No planned activities.</li>'); return; }
  app.itinerary.forEach((it, idx) => {
    const li = $('<li>').addClass('list-group-item d-flex justify-content-between align-items-start itinerary-item').attr('data-idx', idx);
    const left = $(`<div><div class="activity-title"><strong>${it.title}</strong></div><div class="small-muted">${it.date} ${it.time}</div></div>`);
    const right = $(`<div><div class="text-end"><span class="small-muted">$${it.cost}</span><div class="btn-group ms-2"><button class="btn btn-sm btn-outline-success mark-done">Done</button><button class="btn btn-sm btn-outline-danger remove-act">Delete</button></div></div></div>`);
    li.append(left, right);
    if(it.done) li.addClass('completed');
    $it.append(li);
  });
}

// Costs rendering
function renderCosts(){
  const costs = [];
  let total = 0;
  if(app.selections.destination){
    const dest = app.destinations.find(d=>d.id==app.selections.destination);
    // accommodation
    if(app.selections.accommodation){
      const acc = dest.accommodations.find(a=>a.id==app.selections.accommodation);
      costs.push({label:'Accommodation', cost: acc.cost}); total += acc.cost;
    }
    if(app.selections.transport){
      const t = dest.transports.find(x=>x.id==app.selections.transport);
      costs.push({label:'Transport', cost: t.cost}); total += t.cost;
    }
  }
  // itinerary items
  app.itinerary.forEach(it=>{ costs.push({label:it.title, cost: it.cost}); total += it.cost; });
  $('#costs').empty();
  if(costs.length===0) $('#costs').append('<li class="list-group-item small-muted">No costs yet.</li>'); else {
    costs.forEach(c=> $('#costs').append(`<li class="list-group-item d-flex justify-content-between align-items-center"><div>${c.label}</div><div>$${c.cost}</div></li>`));
  }
  $('#total-cost').text('$'+total);
}

// Bind events
$(function(){
  renderDestinations();
  // restore selections
  if(app.selections.destination) selectDestinationById(app.selections.destination);
  if(app.selections.accommodation) $('#accommodation-select').val(app.selections.accommodation);
  if(app.selections.transport) $('#transport-select').val(app.selections.transport);
  renderItinerary(); renderCosts();

  // search
  $('#search-input').on('input', function(){ renderDestinations($(this).val(), $('#filter-type').val()); });
  $('#filter-type').on('change', function(){ renderDestinations($('#search-input').val(), $(this).val()); });
  $('#reset-search').on('click', function(){ $('#search-input').val(''); $('#filter-type').val(''); renderDestinations(); });

  // select destination
  $(document).on('click', '.select-destination', function(){
    const id = $(this).closest('.destination-card').data('id');
    selectDestinationById(id);
  });

  // accommodation change
  $('#accommodation-select').on('change', function(){ app.selections.accommodation = $(this).val(); saveState(); renderCosts(); });

  $('#transport-select').on('change', function(){ app.selections.transport = $(this).val(); saveState(); renderCosts(); });

  // add activity
  $('#add-activity').on('click', function(){
    const actId = $('#activity-select').val();
    const date = $('#activity-date').val();
    const time = $('#activity-time').val();
    if(!app.selectedDestination) { alert('Please select a destination first'); return; }
    if(!actId) { alert('Select an activity'); return; }
    const act = app.selectedDestination.activities.find(a=>a.id===actId);
    const item = { title: act.name, date: date||'Any day', time: time||'', cost: act.cost, done:false };
    app.itinerary.push(item);
    saveState(); renderItinerary(); renderCosts();
    $('#activity-date').val(''); $('#activity-time').val('');
  });

  // itenary actions: delete or mark done
  $(document).on('click', '.remove-act', function(){ const idx = $(this).closest('.itinerary-item').data('idx'); app.itinerary.splice(idx,1); saveState(); renderItinerary(); renderCosts(); });
  $(document).on('click', '.mark-done', function(){ const idx = $(this).closest('.itinerary-item').data('idx'); app.itinerary[idx].done = !app.itinerary[idx].done; saveState(); renderItinerary(); renderCosts(); });

  // clear itinerary
  $('#clear-itinerary').on('click', function(){ if(confirm('Clear all planned activities?')){ app.itinerary=[]; saveState(); renderItinerary(); renderCosts(); }});

  // allow clicking destination card to select as well
  $(document).on('click', '.destination-card', function(e){ if(!$(e.target).hasClass('select-destination')){ const id = $(this).data('id'); selectDestinationById(id); } });

  // simple initial rendering
  renderDestinations();
});
</script>
</body>
</html>
